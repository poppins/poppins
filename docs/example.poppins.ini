; PLEASE DO NOT EDIT THIS FILE

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; INTRODUCTION
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Welcome to Poppins, a command line backup utility for Linux. It is based on rsync/ssh and handles backup rotation based on hardlinks or btrfs/zfs snapshots.
;
; Remember, theses ini file options may always be overridden at the command line.
;
; e.g. $ poppins -c /root/poppins.d/conf/example.ini --remote-host=drizzle
;
; You can use the ini file e.g. as a template.
;
; e.g. $ poppins --remote-host=webserver1 -c webservers.poppins.ini

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; LOCAL
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Configure the server on which you will run the backup script.
[local]

; The root (backup) directory where backups for your hosts will be kept. Typically, this will be a directory containing a subdirectory per remote host.
;
; You must use an absolute path!
rootdir = "/backups"

; Configure the name of the directory in which the backups for your remote host are kept. By default, the directory name is based on the the remote hostname.
;
; You may leave this empty as the hostname will be used as a default.
hostdir-name = ''

; Each backup run will generate a log file. Also, an entry in the poppins.log file will be added per backup run. Define the directory in which these log files are stored.
;
; Use an absolute path.
logdir = "/root/poppins.d/logs"

; By default, snapshots are created using hardlinks. If available, you may want to use zfs or btrfs filesystem snapshots instead.
;
; Values are: "default", "btrfs" or "zfs"
snapshot-backend = "default"

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; REMOTE
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Configure the remote connection. This is the connection to the host you wish to backup. You can take a backup over ssh or run it locally.
[remote]

; Usually, a remote host on the network is your backup target. However, you can run a backup locally as well, e.g. to an external drive. In this case, ssh directives are disregarded. 
;
; By default, ssh is enabked. 
ssh = yes

; Define the ssh remote port, the default is 22.
port = 22

; If no ssh connection can be established immediately, you may want to configure retries. By default, the program will not retry any connection attempts. (0)
retry-count = 0

; You may want to set a timeout in between connection attempts. Timeout between retries is set in in seconds. The default is 5.
retry-timeout = 10

; Set an IP address or resolvable host name for the remote host.
host = 'my.remote.host'

; Set the ssh user for the ssh connection to the remote host. To run certain commands or to make full backups of a remote machine, root privileges are needed. If no user is specified, the user executing poppins is the assumed user.
user = 'root'

; You can run a script on the remote host before every backup run.
;
; Use an absolute path.
pre-backup-script = "/home/poppins/some-pre-backup-script.sh";

; If the remote pre-backup job fails, you can configure to abort or continue the backup procedure.
;
; Values are "abort" or "continue"
pre-backup-onfail = "abort";

; You can run a remote script after every backup run as well. If the backup job fails, you can configure to abort or continue with the post-backup script.
;
; Values are "abort" or "continue".
backup-onfail = "abort";

; You can run a script on the remote host after every backup run.
;
; Use an absolute path.
post-backup-script = "/home/poppins/some-post-backup-script.sh";

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; INCLUDED DIRECTORIES
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Configure included directories and mounts from the remote host in your backups. Remember, rsync will not cross system boundaries by default.
;
; Note: You may override this option by setting the "cross-filesystem-boundaries" in the [rsync] section.
;
; It is recommended to create a directive per partition. The format of the directives is as follows:
; source (remote) = target (local)
;
; e.g. /var = 'var'
;
; Use an absolute path.
[included]

/var = 'var'
/boot = 'boot'
/ = 'root'
/home/poppins/contains\ spaces = contains\ spaces

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; EXCLUDED DIRECTORIES
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; You can exclude certain directories, mounts or partitions from your backups.
;
; Provide a comma separated list of excluded directories per index.
;
; The index is taken from the [included] section. Use a relative path to the index!
[excluded]

/var =  lib/mysql,www
/ = sys,proc,var,boot
; You may include spaces in your path, though this is not recommended.
/home/poppins/contains\ spaces = contains\ other\ spaces

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; SNAPSHOTS
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Configure incremental, minutely, hourly, daily, weekly, yearly snapshots.
[snapshots]

; INCREMENTAL SNAPSHOTS
;
; These backups will be kept until number is reached, in which case the oldest backup will be removed.
incremental = 3

; PERIODIC SNAPSHOTS
;
; Periodic snapshots will be kept until they have reached a certain age.
;
; Syntax: {offset}-{period} = {number of snapshots}
;
; Offset: The first number indicates the offset: e.g. 2-weekly will keep a snapshot every 2 weeks.
; Period: This may include: minutely, hourly, daily, weekly, monthly, yearly.
; Number of snapshots: If this number is reached, the oldest snapshot will be removed.

; keep snapshots every 2 minutes
; 2-minutely = 3

; keep hourly snapshots
; 1-hourly = 24

; keep daily snapshots
1-daily = 7

; keep weekly snapshots (7 days)
1-weekly = 4

; keep snapshots every 2 weeks (14 days)
; 2-weekly = 4

; keep monthly snapshots (note: a month is considered a 30 day period)
1-monthly = 3

; keep snapshots every 6 "months" (note: a month is considered a 30 day period)
; 6-monthly = 5

; keep yearly snapshots
1-yearly = 1

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; METADATA
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Get info from remote machine.
[meta]

; report hardware layout
remote-hardware-layout =  yes

; report remote disk layout
remote-disk-layout =  yes

; report remote package list
remote-package-list =  yes

; include restore scripts
restore-scripts = yes

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; LOG
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Configure some logging options.
[log]

; log total disk usage of backups
local-disk-usage =  yes

; gzip host log file
compress = yes

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; RSYNC
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; Pass some parameters to rsync.
[rsync]

; passed straight to rsync. This is for network transfer only.
compresslevel = 0

; preserve hardlinks, default is no
hardlinks = no

; verbose rsync, default is no
verbose = yes

; retries if desired
retry-count = 0

; timeout between retries in seconds
retry-timeout = 5

; cross filesystem boundaries
cross-filesystem-boundaries = no

; add timestamps to every line of rsync output
timestamps = yes

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; MYSQL
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

; You can configure a backup for your database(s). Supported technologies are MySQL and MariaDB.
[mysql]

; Enable mysql backups, set to yes/no;
enabled = yes

; Remote user directories where .my.cnf files are located. If left empty, home dir is assumed.
;
; This directive must contain absolute paths (or tilde). Multiple directories may be separated by a comma.
;
; e.g. configdirs = '/root,/home/poppins';
configdirs = /root,/home/poppins

; INCLUDED DATABASES
;
; By default, all databases are included in the backup, except for sys and information_schema.
;
; If desired, you can include a specific set of databases instead. Note, this features is not supported in combination with multiple .my.cnfs
;
; You may use a regular expressions (Perl synxtax) within slashes "/"
; e.g. '/^drupal_.*/' # all databases starting with string 'drupal_'
;
; included-databases = 'wordpress_1,wordpress_2,/^drupal_.*$/'

; EXCLUDED DATABASES
;
; By default, all databases are included in the backup, except for sys and information_schema.
;
; If desired, you can exclude a specific set of databases instead. Note, this features is not supported in combination with multiple .my.cnfs
;
; You may use a regular expressions (Perl synxtax) within slashes "/"
; e.g. '/^drupal_.*/' # all databases starting with string 'drupal_'
;
; excluded-databases = '/^drupal_test.*/'

; IGNORE TABLES
;
; ignore specific tables within the databases
; Use dot notation "database.table" or regex "/<REGEX>/" (Perl synxtax)
; e.g. '/database1\.tbl.*/' # all tables in database1 starting with string tbl
; default is every table except mysql.event
; ignore-tables = '/^wordpress1\.test_.+/'

; INCLUDED TABLES
;
; include specific tables in "tables" or "csv" output
; not supported in combination with multiple .my.cnfs
; Use dot notation "database.table" or regex "/<REGEX>/" (Perl synxtax)
; e.g. '/^database1\.tbl.*$/' # all tables in database1 starting with string tbl
; included-tables = '/^wordpress4\.tbl_.+/'

; EXCLUDED TABLES
;
; excluded-tables = ''

; output types: databases dumps, table dumps or tab seperated file (csv)
; use values database, table or csv (or combination)
output = 'database,table,csv'

; mysqldump create database statement
create-database = yes

; compress the dumps (gzip)
compress = yes
